import{c as a,a as o}from"./messages-BSmwHoPL.js";chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0});chrome.runtime.onMessage.addListener((e,s,t)=>(e.type==="FORK_BRANCH"&&c(e.payload),!0));async function c(e){var t;console.log("Forking w/ history size:",((t=e.fullHistory)==null?void 0:t.length)||0);const s=await a({label:e.content?`${e.content.slice(0,15)}...`:"Forked Branch"});if(e.fullHistory&&e.fullHistory.length>0){let r;for(const n of e.fullHistory){const i=n.role==="user"||n.role==="assistant"||n.role==="system"?n.role:"user";r=(await o({branchId:s.id,role:i,content:n.content,parentId:r})).id}}else await o({branchId:s.id,role:"system",content:"Fork created (no history captured)"});console.log("Created branch:",s.id),chrome.runtime.sendMessage({type:"REFRESH_BRANCHES"})}
